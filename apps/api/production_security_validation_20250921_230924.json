{
  "timestamp": "2025-09-21T23:09:23.729566",
  "validation_type": "production_security",
  "environment": "production",
  "tests": {
    "secret_key_strength": {
      "test_name": "Secret Key Strength",
      "passed": true,
      "details": {
        "length": 86,
        "length_check": "PASS",
        "complexity_score": "4/4",
        "is_default_key": false
      }
    },
    "https_configuration": {
      "test_name": "HTTPS Configuration",
      "passed": true,
      "details": {
        "ssl_redirect_enabled": true,
        "hsts_max_age": 63072000,
        "hsts_min_requirement": 31536000,
        "https_origins": 2,
        "insecure_origins": 0
      }
    },
    "security_headers": {
      "test_name": "Security Headers",
      "passed": true,
      "details": {
        "present_headers": [
          "Content-Security-Policy",
          "X-Frame-Options",
          "X-Content-Type-Options",
          "X-XSS-Protection",
          "Referrer-Policy"
        ],
        "missing_headers": [],
        "total_required": 5,
        "total_present": 5,
        "header_checks": {
          "x_frame_options": true,
          "x_content_type_options": true,
          "csp_default_src_self": true,
          "csp_object_src_none": true
        }
      }
    },
    "cors_configuration": {
      "test_name": "CORS Configuration",
      "passed": true,
      "details": {
        "allowed_origins": [
          "https://example.com",
          "https://www.example.com"
        ],
        "has_wildcard_origin": false,
        "insecure_origins": [],
        "allow_credentials": true
      }
    },
    "rate_limiting": {
      "test_name": "Rate Limiting",
      "passed": true,
      "details": {
        "rate_limits": {
          "default": 100,
          "auth": 10,
          "upload": 20,
          "public": 200,
          "POST:/api/v1/posts": 30,
          "POST:/api/v1/posts/*/reactions": 60,
          "POST:/api/v1/posts/*/share": 20,
          "POST:/api/v1/follows/*": 30,
          "GET:/api/v1/follows/*/status": 200,
          "GET:/api/v1/users/*/followers": 100,
          "GET:/api/v1/users/*/following": 100,
          "GET:/api/v1/users/*/follow-stats": 150,
          "POST:/api/v1/users/search": 60,
          "GET:/api/v1/notifications": 120
        },
        "default_limit": 100,
        "auth_limit": 10,
        "reasonable_limits": true
      }
    },
    "security_test_suite": {
      "test_name": "Security Test Suite",
      "passed": false,
      "details": {
        "exit_code": 4,
        "stdout": "",
        "stderr": " error: unrecognized arguments: --json-report --json-report-file=/tmp/security_test_results.json\n  inifile: /home/danha/Projects/Kiro/greatful/apps/api/pytest.ini\n  rootdir: /home/danha/Projects/Kiro/greatful/apps/api\nFor more information see https://pluggy.readthedocs.io/en/stable/api_reference.html#pluggy.PluggyTeardownRaisedWarning\n  config = pluginmanager.hook.pytest_cmdline_parse(\nSecurity configuration warnings:\n  WARNING: Production environment variable FRONTEND_BASE_URL is not set\n  WARNING: Database URL contains development indicator: test\n  WARNING: CSP contains 'unsafe-eval' - consider removing if possible\n  WARNING: CSP contains 'unsafe-inline' - consider using nonces or hashes\nERROR: usage: __main__.py [options] [file_or_dir] [file_or_dir] [...]\n__main__.py: error: unrecognized arguments: --json-report --json-report-file=/tmp/security_test_results.json\n  inifile: /home/danha/Projects/Kiro/greatful/apps/api/pytest.ini\n  rootdir: /home/danha/Projects/Kiro/greatful/apps/api\n\n"
      }
    }
  },
  "summary": {
    "total_tests": 6,
    "passed_tests": 5,
    "failed_tests": 1,
    "success_rate": 83.33333333333334,
    "production_ready": false,
    "critical_issues": 1,
    "recommendations_count": 1,
    "security_status": "MODERATE"
  },
  "recommendations": [
    "Fix failing security tests before production deployment"
  ]
}